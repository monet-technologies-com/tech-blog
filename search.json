                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      [{"title":"ルート検索OSS (OSRM) の予測精度を調べました","url":"/tech-blog/2020/08/30/ルート検索OSS (OSRM) の予測精度を調べました/","content":"システム部の登山担当太田です山はいいぞ今回はルート検索の OSS である OSRM を検証した話です地図データには OSM を用いています導入は別で書きます# 前談# ルート検索のコスト削減MONET ではオンデマンドバスサービスを提供していますがその裏ではルート検索による時間取得のロジックが何度もはしっていますマッチングの最適化など今後進めていくにあたってもルート検索のコストは抑えたいところですそこで信頼性をある程度担保して低コストなルート検索できないかな？ということで OSS の有効性を検証しました# OSM とは素晴らしい取り組みとして Open Street Map (OSM) という地理情報をみんなで作って行こうぜ！オープンライセンスで誰にでも使えるようにしようぜ！というイカしたプロジェクトがあります Open Street Map では所々足りていない情報はありますが道路のクラス分けや店舗の情報までオープンライセンスと考えれば十分すぎるほどの地理データが利用できますOSM で利用可能な情報○道路分類，建物分類，各名称×公共交通機関，交通量 もちろん自分たちで編集ができ，自宅の周りとか眺めてポチポチするだけで世界の地理データベース作成に貢献できるのでぜひやってみてください！# OSRM とはルート検索エンジンの OSS です. 中身のアルゴリズムは multi dikstra で OSM の地図情報を基に最短ルートを決定します. (他のアルゴリズムも使用可) 高速道路を省いたり，U ターンを禁止したりなど痒いところの設定までできてしまう優れものです.Mapbox でも採用されていたりします. ブログ記事ルート検索だけでなく MapBox でも採用されていたりしますこのルート検索エンジン使ってどれくらい正しく予測できるの？というのが今回のお題です# OSRM ってどんな感じで動いてますん実装までは他記事でも紹介されているので省きますがザクっとこんな感じですOSM の最新地図情報を保存lua ファイル定義に従って重み付けされたグラフを作成HTTP サーバーを起動してリクエスト# 検証最初に東京都内の限られた範囲でランダムに 2 点を限られた範囲でのルート検索制度を検証しました. 検証範囲は以下になります. この中で 1000 回程度 Google Direction API, OSRM API どちらも叩いて統計差がどれくらいか，変なルート通っていないか比較しました.設定はこんな感じです両方とも高速道路を通らないDirection API は trafficMode=optimisticOSRM は交通量情報を考慮しないOSRM の設定 lua ファイルはデフォルト (car.lua) のまま# 結果# 予測結果ランダムに 1 つ抜き出してきました. ルートは似たようなルートを通っていますが時間が結構ずれています.# 距離誤差＆時間誤差距離 / 時間の相対誤差のヒストグラムは以下のようになりました. ルート可視化と同様に，距離誤差はデフォルトでもある程度正しいですが時間誤差が大きいので修正が必要です.# 速い道路，遅い道路の区分け適当に低速，中速，高速で分けると高速の比率が大きいほど予測を外していることが分かりました.# チューニング上記の結果を踏まえてチューニングを行いました.lua ファイル内では道路のタグ名ごとに初期設定速度を入れています. 今回はそちらを定数倍する大雑把な修正を行いました.これで統計的な情報をある程度合わせられる！(チューニングですので)# チューニング結果こんな感じになりました散布図 ヒストグラム平均はあるていど合わせられましたが分散まで Google の予測と同様とはやはり行かなかったです. 交通量の考慮も入ってくるのでそのままの代用は難しいですね. 一方，大きく外すわけではないので裏のロジックに使用したりとか使い道を考えれば導入できるのでは？という感触でした# まとめGoogle と比較して検証しました全体大きくは外さないですがダメな時もありましたどこまでの精度求めるかによりますが存外使えるかもという事で裏側ロジックでの実装と導入どの部分に使うかを模索することになりました."},{"title":"Arch Linuxはいいぞという話","url":"/tech-blog/2020/08/18/Arch Linuxはいいぞという話/","content":"# はじめにMONET Technologies 株式会社、2020 年新卒入社の竹内です。この記事では、自分のおすすめする　Linux ディストリビューションである Arch Linux についてちょろっと書かせて頂きます。# Arch Linux が好きです。エンジニアなら一度は辿り着く境地、 「オレオレカスタマイズしたマイスイート PC を作りたい」自分はハードウェアがそこそこの PC に、どんなソフトを載せるか、というところが好きです (自作 PC 勢のお話も是非聴いてみたいですが)。そんな自分が大学生の時からお世話になっているのが、Arch Linux という Linux のディストリビューションです。# 何がいいの？めちゃくちゃ軽量 &amp; 爆速 (個人の感想です)パッケージマネージャが優秀 (ほとんどのソフトを一つのパッケージマネージャで完結できて嬉しい)最初にミニマムな要素 (CLI 環境) しか入っていないので、ウィンドウマネージャなどを自分の好みで入れられるこの辺が自分のツボです。特に、高校生の頃に買った弱い PC に Arch を入れた時、あんなに Windows が重かったのが爆速で動くようになった感動を今でも忘れられません。# まぁ諸説あるけどとはいえ、確かに、 少しメンテナンスが面倒くさい こともあるかもしれません。特に、Arch には始め殆どの要素は入っていない状態からスタートするので、デスクトップ環境を構築するまでが面倒だったり、カーネルのアップデートで起動しなくなったり、ということも無くはないです。が、手のかけた子ほど可愛い、そう思いませんか？(個人の意見です)何か問題が起きたとしても、Arch Wiki がかなり優秀なので、大抵なんとかなります。余談ですが、Ubuntu など別の Linux ディストリビューションを使っても Arch Wiki の情報で助かったりするので、優秀なドキュメントになっているなと感じます。# おすすめのウィンドウマネージャせっかくなので、Arch Linux 上での構成を少しだけお話します。自分はウィンドウを画面一杯、もしくは二つのウィンドウを右と左に分けて、と言った感じで敷き詰めるのが好きなので、タイル型のウィンドウマネージャが好きです。自分の PC に入れているのは、awesome というウィンドウマネージャです。こちらを使うと、ショートカットキーでウィンドウの配置フォーカスの切替などが簡単にできるので好みです。さらに、google-chrome の remote desktop も入るので、自宅の PC に Arch Linux を入れて、リモートデスクトップを経由して手元の PC から作業、なんてこともできます。リモートデスクトップの割に爆速で、中でどんな仕組みになっているか気になっちゃいますね。。。# まとめArch Linux はいいぞ。","tags":["Arch Linux","Linux"],"categories":["おすすめ技術"]},{"title":"技術ブログ始めました(VSCodeの設定編)","url":"/tech-blog/2020/07/15/技術ブログ始めました(VSCodeの設定編)/","content":"# はじめにMONET Technologies 株式会社、2020 年新卒入社の竹内です。この記事では、技術ブログ開始に当たって、VSCode での Hexo 記事執筆環境を導入した話です。全体構成のお話は技術ブログ始めました(構成編)でお話しています。静的サイトジェネレータである Hexo を導入したお話は技術ブログ始めました(Hexo-on-Docker編)でお話しています。# 楽な執筆環境に向けて技術ブログ、エンジニアの方なら一度は書こうとするものだと思うのですが、3 ヶ月続けられた方には心からの拍手を送りたいです。やはり、モノを書く、アウトプットするのってコストが高いんですよね。単なるメモ程度なら雑に書いても良いわけですが、ブログとして書こうとするとある程度体裁を整えないといけなかったり。。。といったことを考えると、筆が重くなり。。。そこで今回は、執筆を楽にするためのツール、VSCode 上のエクステンションを紹介してみます。# vscode-hexo-utilsHexo+VSCode で執筆する際には必須のエクステンションです。この vscode-hexo-utils を使うと記事一覧やタグ一覧を表示するサイドバーの追加マークダウンに画像を挿入したプレビュー時、Hexo ならではの画像ディレクトリ構成に対応してプレビューを見せてくれるWin:ctrl-alt-v Mac:opt-cmd-v でクリップボードの画像を貼り付け (記事に対応した画像配置用ディレクトリの作成とマークダウン上の参照文記述)などなどしてくれるので大分執筆が楽になります。特に画像の挿入は重要なので、開発者には頭が上がりません。# Remote Developmentこちらは Docker など、リモートとして作った環境に対して VSCode を接続できるエクステンションです。今回は Docker 上に Hexo や Git を構成しているので、直接接続して、Docker 上のコマンドを呼び出す、なんてことが簡単になります。ただ、残念なことが、 リモートで接続した際にクリップボードが共有化されていないらしく、上記の vscode-hexo-utils の画像コピペ機能が上手く働きません。そのため、こちらは残念ながら、執筆中には使えない感じになっています。。。もしクリップボードの共有化ができると、vscode を直接 Docker に繋げるvscode-hexo-utils を使いながら執筆直接 Docker 内のコマンドを叩いてデプロイといった使い方ができるようになります。もちろん今の Remote Development 機能も大変良いモノで、友人なんかは、RaspberryPi などでリモート環境を作る、VSCode でリモート接続して手元の PC で IoT 開発、なんてこともしているのでおすすめです。# VSCode のタスク機能今回は Docker を通じてのデプロイになりますが、VSCode の方でコマンドを打ってデプロイまで行いたいですよね。そこで使うのが、VSCode のタスク機能です。参考になるのがこちらです。自分はというコマンドを登録して、VSCode から Docker 上の Git を叩き、push するとともにデプロイを行っています。このタスク機能を使えば、任意のコマンドを VSCode 上で使えるので良いですね。# vscode-drawio最後に紹介するエクステンションは、vscode-drawio です。こちらはブラウザ上で動く draw.io を vscode 上で動かそうというモノで、簡単な図を書きたい時に使えます。この、なんでもエディタ上にのせてやろうという心意気、自分は嫌いじゃないです。笑# まとめ様々な VSCode のエクステンションがあって、見ていて楽しいです。もちろんエンジニアは何を生み出すか、も重要ですが、たまには息抜きに自分の道具を磨いて見るのも良いですね。","tags":["hexo","vscode"],"categories":["ブログ環境"]},{"title":"技術ブログ始めました(Hexo-on-Docker編)","url":"/tech-blog/2020/07/15/技術ブログ始めました(Hexo-on-Docker編)/","content":"# はじめにMONET Technologies 株式会社、2020 年新卒入社の竹内です。この記事では、技術ブログ開始に当たって、静的サイトジェネレータ Hexo を導入した話です。全体構成のお話は技術ブログ始めました(構成編)でお話しています。# Docker 使ってみますさて、それでは本題に入っていきましょう。前提として、今回は Hexo 環境を Docker で構築します。Docker 環境自体の構築についてはこちらを参照しました。筆者は今回初めて Docker を使ってみているので、変なところがあれば指摘していただければと思います。流れとしては、執筆用 Docker イメージのビルドDocker コンテナの実行といったところです。# 執筆用 Docker イメージのビルドまず、執筆用の Docker イメージをビルドするところから始まります。Hexo 用の Docker イメージとしてこちらを参考にしました。Dockerfile をお好みに記述したら、記述したファイルの存在するディレクトリ上で、とすれば Docker イメージがビルドされます。上記リンクで紹介した Docker ファイルではHexo 環境の導入デプロイ用 Git の導入 (SSH キーの配置も含めて)まで行ってくれるようになっています。今回は、ブログのソースリポジトリを Github にプッシュGithub Pages の公開用リポジトリを更新という流れを自動化したかったので、Git の hook 機能を使って Hexo のコマンドを紐づけるようにしています。具体的には、Hexo 用のデプロイコマンドを記述したファイル pre_push  を作り、~/.git/hooks/  以下に配置するようにしています。今回は push する前という hook になっていますが、複数人で編集することを考えると、リモートリポジトリでのマージが終わったタイミングの方が良かったかもしれないと思っています。が、今回 Github がリモートリポジトリになっているので、リモートサーバ上での hook が実装できず、ひとまず push をトリガーにしています。Gitlab など自前で Git サーバを立てている際には、ブログを書く時にはまず執筆ブランチを切るブログ執筆後、執筆ブランチ上の変更を pushリモートリポジトリで執筆ブランチをマスターブランチにマージマージ後の hook で公開用リポジトリへソースをデプロイみたいな流れが安全そうです。# Docker コンテナの実行Docker イメージをビルドしたら、でコンテナを作成し開始します。これを行うことで、Docker コンテナ上の Hexo サーバが動き、http://localhost:4000を参照することでローカルなサイトのプレビューができるようになります。# まとめDocker を使うことによって、複数人が使うブログの執筆環境をある程度簡易に構築することができました。便利なツールが増える一方、依存関係などで導入が面倒になることもよくあるので、Docker のようなツールもうまく使えるとよりハッピーになりそうですね。時代の主流は SaaS でローカルに環境を整える場面も少なくなってきそうですが。。。","tags":["hexo"],"categories":["ブログ環境"]},{"title":"技術ブログ始めました(構成編)","url":"/tech-blog/2020/07/14/技術ブログ始めました(構成編)/","content":"# はじめにMONET Technologies 株式会社、2020 年新卒入社の竹内です。この度、弊社でも社員の技術力向上 &amp; アウトプットのために、技術ブログを開設する運びとなりました。記念すべき 1 回目の記事は、この技術ブログの立ち上げについて一通り書きます。# 技術ブログの選定技術ブログを作成するに当たって考えたのは、サーバの維持コスト記事の管理コスト執筆環境の 3 点です。技術ブログを公開するというということは当然 Web サーバが必要になるわけですが、そこにコストやメンテナンスが必要になると継続するのが面倒です。なので、何か外部のサービスを使って公開したいという要求があります。また、ページを編集したら、編集履歴や差分まで管理したいです。更に、執筆環境としては、普段コードを書いたりするエディタを使ってそのまま書きたいですよね。ということで、今回は静的サイトジェネレータ Hexo と Github Pages を使って技術ブログを作ってみることにしました。ただ、今回用いる Hexo は Node.js で作られており、バージョン管理などが面倒です。そこで、今回は、生成環境：Docker 上の Hexo執筆環境：Visual Studio Code などの各自のエディタ公開環境：Github Pagesという構成で全体を組みました (もちろん執筆環境はお好きなエディタを使ってください)。全体構成のイメージはこんな感じです。次回からそれぞれの環境について執筆していきます。# まとめ技術ブログを始めるので皆様ゆるゆるとお付き合いください！","tags":["hexo","vscode","github","docker"],"categories":["ブログ環境"]}]